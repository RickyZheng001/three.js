<!DOCTYPE html>
<html lang="en">
<head>
    <title>刀盘式c</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <meta http-equiv="Access-Control-Allow-Origin" content="*">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="cache-control" content="no-cache">
    <meta http-equiv="expires" content="0">
    <link href="https://fonts.googleapis.com/css?family=Electrolize:400" rel="stylesheet" type="text/css">
    <script async="" src="//www.google-analytics.com/analytics.js"></script>
    <script type="text/javascript" src="./js/jquery-ui-1.10.4.custom/js/jquery-1.10.2.js"></script>
    <script type="text/javascript" src="./js/jquery-ui-1.10.4.custom/js/jquery-ui-1.10.4.custom.min.js"></script>
    <script type="text/javascript" src="../dat.gui-master/build/dat.gui.js"></script>
    <link rel="stylesheet" href="../dat.gui-master/build/dat.gui.css" type="text/css">
    <link rel="stylesheet" href="style.css" type="text/css" media="screen">
    <link rel="stylesheet" href="./js/jquery-ui-1.10.4.custom/css_smoothness/jquery-ui.css">
    <link rel="stylesheet" href="right_menu.css">
    <link rel="stylesheet" href="ModalFrame.css">
    <script type="text/javascript" src="ModalFrame.js"></script>
    <script type="text/javascript" src="gui.js"></script>
    <script type="text/javascript" src="config.js"></script>

    <script src="../build/three.js"></script>
    <script src="../build/three.module.js"></script>
    <script src="../dat.gui-master/tests/jquery.js"></script>

    <script src="../examples/js/controls/OrbitControls.js"></script>
    <script src="../examples/js/QuickHull.js"></script>
    <script src="../examples/js/geometries/ConvexGeometry.js"></script>
    <script src="../examples/js/Detector.js"></script>
    <script src="../examples/js/libs/stats.min.js"></script>
    <script src="../examples/js/loaders/STLLoader.js"></script>
    <script src="../examples/js/loaders/OBJLoader.js"></script>
    <script src="../examples/js/loaders/PLYLoader.js"></script>

    <script src="./utils/LoadGui.js"></script>
    <script type="text/javascript">

    </script>
</head>

<body class="unselectable">

<div id="content">
    <div class="centeredDiv">
        <div class="header">
            <div><img src="./images/logo.png" width="179" style="margin-left: 20px;"></div>
            <div><img src="./images/Designlogo.png" width="159px" style="position: absolute;margin-left: 31%;margin-top:-7px;width: 291px;height:72px; "></div>
            <div class="menu2">
                <ul class="menu2">
                    <li id="menu2_a" style="text-align: left">
                        欢迎您:&nbsp;<a id="username">123</a>
                    </li>
                    <li id="menu2_b">
                        积分:&nbsp;<a id="jifen">888</a>
                    </li>
                    <li class="lis">
                        <a color="#ffffff">账单查询</a>
                    </li>
                    <li class="lis">
                        <a>返回首页</a>
                    </li>
                    <li class="lis">
                        <a>退出</a>
                    </li>
                </ul>
                <li id="liid">公司名称:&nbsp;<a id="company">中华人民共和国上海市嘉定区嘉罗公路1661弄</a></li>
            </div>
            <ul class="info">
                <li id="loginOrLogout" class="info"><a class="info" href="/shop/login.php">login</a></li>
                <li id="myAccount" class="info" style="display:none;"><a class="info" href="/shop/account.php">my account</a></li>
                <li id="cartLabel" class="info"><a class="info" href="/shop/shopping_cart.php">cart:</a>
                    <span id="cartContents" style="font-size:9px">
						 0 items						 </span>
                </li>
            </ul>
        </div>
    </div>
    <div class="app">
        <!-- facebook like button stuff -->
        <div id="fb-root"></div>
        <!-- end facebook stuff -->
        <div class="appTitle">
            <div id="LeftPanel">
                <div class="appName" style="position: absolute;margin-left: 40px;margin-top: 0px;">整体钻头</div>
                <div class="appName2" style="position: absolute;margin-left: 50px;margin-top: 80px;">普通钻头</div>
                <div class="appName3" style="position: absolute;margin-left: 50px;margin-top: 80px;">螺旋槽钻头</div>
                <div class="smallbutton" style="position: absolute;margin-left: 10px;margin-top: 120px;width:100px;" onclick="Display3DModel()">更新显示三维</div>
                <select id="SanWeiComboBox" style="position: absolute;margin-left: 130px;margin-top: 122px;width:80px;" onchange="OnSanWeiComboBoxChanged()">
                    <option value ="0">刀具</option>
                    <option value ="1">刀柄</option>
                    <option value ="2">延长杆</option>
                    <option value ="3">装配</option>
                </select>
                <div class="smallbutton" style="position: absolute;margin-left: 10px;margin-top: 150px;width:100px;" onclick="DisplayTuZhi()">更新显示二维</div>
                <select id="ErComboBox" style="position: absolute;margin-left: 130px;margin-top: 152px;width:80px;" onchange="OnErWeiComboBoxChanged()">
                    <option value ="0">刀具</option>
                    <option value ="1">刀柄</option>
                    <option value ="2">延长杆</option>
                    <option value ="3">装配</option>
                </select>

                <div class="smallbutton" style="position: absolute;margin-left: 10px;margin-top: 180px;cursor:default;">夹持结构 </div>

                <select id="YanChangGanComboBox" style="position: absolute;margin-left: 100px;margin-top: 182px;width:116px;" onchange="OnJiaChiJieGouSelectionChanged()">
                    <option value ="0">刀柄+刀具</option>
                    <option value ="1">刀柄+延长杆+刀具</option>
                </select>
                <div class="smallbutton" style="position: absolute;margin-left: 10px;margin-top: 210px;width:200px;" onclick="OnClickZuanTouSearch()">整体钻头  搜索</div>
                <div class="smallbutton" style="position: absolute;margin-left: 10px;margin-top: 240px;width:200px;" onclick="OnClickParamDesign()">整体钻头  参数设计</div>
                <div class="smallbutton" style="position: absolute;margin-left: 10px;margin-top: 270px;width:100px;" onclick="OnClickZuanTouSearch()">刀具夹持长度</div>
                <input style="position: absolute;margin-left: 130px;margin-top: 270px;width:50px;" type="text" name="jiaChiLength" />
                <div style="position: absolute;margin-left: 190px;margin-top: 270px;width:40px;">mm</div>
                <div class="smallbutton" style="position: absolute;margin-left: 10px;margin-top: 300px;width:200px;" onclick="OnClickHandleSearch()">刀柄搜索</div>
                <div id="YanChangGanBtn" class="graybutton" style="position: absolute;margin-left: 10px;margin-top: 330px;width:200px;" onclick="OnClickYanChangGanSearch()">延长杆搜索</div>
                <div class="smallbutton" style="position: absolute;margin-left: 10px;margin-top: 360px;width:100px;" onclick="OnClickZuanTouSearch()">延长杆夹持长度</div>
                <input style="position: absolute;margin-left: 130px;margin-top: 360px;width:50px;" type="text" name="yanChangGanLength" />
                <div style="position: absolute;margin-left: 190px;margin-top: 360px;width:40px;">mm</div>
                <div class="smallbutton" style="position: absolute;margin-left: 10px;margin-top: 390px;width:200px;" onclick="OnClickJiShuYaoQiu()">技术条件</div>
                <div class="smallbutton" style="position: absolute;margin-left: 10px;margin-top: 420px;width:200px;" onclick="OnClickTuZhiMuBan()">图纸模板</div>
            </div>
        </div>
        <div id="canvas">
            <div id="gameCanvas" width="1920px" height="1080px"></div>
            <div id="divPdfView" class="pdfView" style="visibility: hidden">
                <embed id="pdfCtrl" src="./pdf/test1.pdf" type="application/pdf" width="1440px" height="670"></embed>
            </div>

            <div id="SearchTable" style="visibility: hidden">
                <table class="editableTable" border="0" style="position: absolute;left: 300px;top: 200px;overflow:scroll;width: 800px;">
                    <tr class="editable simpleInput">
                        <th style="width: 60px;">序号</th>
                        <th style="width: 60px;">名称</th>
                        <th style="width: 60px;">总长</th>
                        <th style="width: 60px;">柄部直径</th>
                        <th style="width: 60px;">直径</th>
                        <th style="width: 60px;">
                            <div class="closebutton" style="position: absolute;width: 30px;margin-left: 14px;margin-top: -9px;padding-left: 0px;padding-top: 0px;" onclick="HideSearchResultPanel()">关闭</div>
                        </th>
                    </tr>
                    <tr class="editable simpleInput">
                        <td>1</td>
                        <td>钻头</td>
                        <td>237</td>
                        <td>10</td>
                        <td>10</td>
                        <td>
                            <div class="smallbutton" style="position: absolute;width: 30px;margin-left: 14px;margin-top: -9px;padding-left: 0px;padding-top: 0px;" onclick="DisplayTuZhi()">更新</div>
                        </td>
                    </tr>
                    <tr class="editable simpleInput">
                        <td>2</td>
                        <td>钻头2</td>
                        <td>237</td>
                        <td>10</td>
                        <td>10</td>
                        <td>
                            <div class="smallbutton" style="position: absolute;width: 30px;margin-left: 14px;margin-top: -9px;padding-left: 0px;padding-top: 0px;" onclick="DisplayTuZhi()">更新</div>
                        </td>
                    </tr>
                    <tr class="editable simpleInput">
                        <td>2</td>
                        <td>钻头3</td>
                        <td>237</td>
                        <td>10</td>
                        <td>10</td>
                        <td>
                            <div class="smallbutton" style="position: absolute;width: 30px;margin-left: 14px;margin-top: -9px;padding-left: 0px;padding-top: 0px;" onclick="DisplayTuZhi()">更新</div>
                        </td>
                    </tr>
                    <tr class="editable simpleInput">
                        <td>2</td>
                        <td>钻头4</td>
                        <td>237</td>
                        <td>10</td>
                        <td>10</td>
                        <td>
                            <div class="smallbutton" style="position: absolute;width: 30px;margin-left: 14px;margin-top: -9px;padding-left: 0px;padding-top: 0px;" onclick="DisplayTuZhi()">更新</div>
                        </td>
                    </tr>
                    <tr class="editable simpleInput">
                        <td>2</td>
                        <td>钻头5</td>
                        <td>237</td>
                        <td>10</td>
                        <td>10</td>
                        <td>
                            <div class="smallbutton" style="position: absolute;width: 30px;margin-left: 14px;margin-top: -9px;padding-left: 0px;padding-top: 0px;" onclick="DisplayTuZhi()">更新</div>
                        </td>
                    </tr>
                </table>
            </div>
            <div id="divParamList" style="position: absolute;z-index: 0;left: 320px;bottom: 220px;width: 400px;visibility: hidden;">
            </div>
            <div id="techRequest" style="position: absolute;z-index: 0;left: 520px;bottom: 220px;width: 600px;visibility: hidden;">
            </div>

            <div id="ModelGenerateProgressBar" style="visibility: hidden;position: absolute" left="200px" top="200px" ></div>

            <div id="toolBoxTuZhi" class="toolBox" style="visibility: hidden">
                <div class="section section_material">
                    <div class="appLabel">二维工程图下载</div>
                    <div class="button" onclick="">PDF</div>
                    <div class="button" onclick="">DWG</div>
                    <div class="button" onclick="">打包下载</div>
                </div>

                <div class="nervousLogo noSel">
                    <img src="images/EdgeWinLogo_3.png">
                </div>
            </div>



            <div id="toolBox3D">
                <div class="section section_sculpt">
                    <div id="appLabel" class="appLabel">
                        <table class="tab">
                            <tr>
                                <td class="right_td">装配</td><td id="zhuangpeibut" class="right_td">No</td>
                            </tr>
                            <tr>
                                <td class="right_td">刀片</td><td id="daojubut" class="right_td">No</td>
                            </tr>
                            <tr>
                                <td class="right_td">外圆槽刀杆</td><td id="daobingbut" class="right_td">No</td>
                            </tr>

                        </table>
                    </div>
                    <div  ><img style="margin-top:10px;position:absolute;border: #009fd7" src="images/bji.png"
                                height="184" width="169	"/></div>
                    <div class="panel" style="width:170px;margin-top: 10px;position:absolute;z-index: 1"><div class="smallbutton" style="position:absolute;left:0px;top:-30px;" onclick="QueryServerState()">Check</div><div class="smallbutton" style="position:absolute;left:84px;top:-30px;" onclick="Help()">Help</div>

                        <div class="right_t" onclick="activateButton('zhouCeView');"></div>
                        <div class="right_t" onclick="activateButton('rightView');"></div>
                        <div class="right_t" onclick="OnClickDisplayZuoBiaoZhou();"></div>
                        <div class="right_t" onclick="activateButton('mainView');"></div>
                        <div class="right_t" onclick="activateButton('topView');"></div>
                        <div class="right_t" onclick="OnClickDisplayXZPlane();"></div>
                        <div class="right_t" onclick="activateButton('backView');"></div>
                        <div class="right_t" onclick="activateButton('bottomView');"></div>
                        <div class="right_t" onclick="OnClickDisplayYZPlane()"></div>
                        <div class="right_t" onclick="activateButton('leftView');"></div>
                        <div class="right_t"></div>
                        <div class="right_t" onclick="OnClickDisplayXYPlane()"></div>


                        <div class="smallbutton" style="width: 160px;margin-top: 10px" onclick="OnClickBaoJia()">报价信息</div><div class="smallbutton" style="width: 160px;margin-top: 10px" onclick="OnClickQieXiao()">切削参数</div><div class="smallbutton" style="width: 160px;margin-top: 10px" onclick="OnClickDownload()">下载</div><div class="smallbutton" style="width: 160px;margin-top: 10px" onclick="OnClickLuiYan()">留言建议</div>
                        <!--<button id="buttons" onclick="OnClickStoreroom()">保存</button>-->
                    </div>
                    <div class="nervousLogo noSel" style="position: absolute;right: 615px;bottom: -410px">
                        <img src="images/EdgeWinLogo_3.png">
                    </div>
                </div>
            </div>
        </div>
    </div>



    <div id="modal_overlay">
        <div class="modal_data">
            <div id="modal_top"><b style="margin: 10px ;">装配</b></div>
            <div id="modal_main">
                <p id="p_top">***********  装配结果  ***********</p>
                <p class="p_main">总长度不能小于工作长度</p>
                <p class="p_main" style="margin-bottom:42px ">工作直径不能小于0.1mm</p>
                <center>
                    <button id="modal_button" onclick="OnClickOverlay()" href="">关闭</button>
                </center>
            </div>

        </div>
    </div>


    <div id="download">
        <div id="download_title">
            <div style="width: 50px;margin: 3px 0 0 5px;">下载</div>
            <div style="width: 11px;margin: 4px 0 0 262px;cursor:pointer;" onclick="OnClickEsc()" >X</div>
        </div>
        <div id="download_main">
            <div id="download_main_top">
                <div class="Dtitle">干涉检查:</div>
                <div class="Dtitle_left"><input class="che" type="checkbox" value="10" name="fruit"></div><div class="Dtitle_right"><a>1:1装配DWG</a><a class="check_right">10.00元</a></div>
                <div class="Dtitle_left"><input class="che" type="checkbox" value="10" name="fruit"></div><div class="Dtitle_right"><a>装配STEP</a><a class="check_right">10.00元</a></div>
                <div class="Dtitle">报价简图:</div>
                <div class="Dtitle_left"><input class="che" type="checkbox" value="5" name="fruit"></div><div class="Dtitle_right"><a>装配PDF+刀具PDF</a><a class="check_right">5.00元</a></div>
                <div class="Dtitle_left"><input class="che" type="checkbox" value="5" name="fruit"></div><div class="Dtitle_right"><a>装配DWG+刀具DWG</a><a class="check_right">5.00元</a></div>
                <div class="Dtitle_left"><input class="che" type="checkbox" value="10.00" name="fruit"></div><div class="Dtitle_right"><a>刀具STEP</a><a class="check_right">10.00元</a></div>
            </div>
            <div id="download_d">
                <div class="Dtitle">下载方式:</div>
                <div style="margin-left: 50px">
                    <input type="radio" value="0" name="download">本地下载
                    <input style="margin-left: 40px" type="radio" value="1" name="download">邮箱下载
                </div>
            </div>
        </div>
        <div id="download_bottom">
            <div style="padding-top: 6px;margin-left: 188px">合计</div>
            <div id="myspan" style="margin: 3px 0px 0px 15px;padding: 2px 4px;width:70px;color: black;text-align: center">0.00元</div>
        </div>
        <div id="download_foot">
            <div class="Dtitle_f">支付方式：</div>
            <div><img style="margin: 10px 10px 10px 34px;cursor:pointer;" src="images/zhifubao.jpg" height="47" width="122"/><img style="margin: 10px 34px 10px 10px;cursor:pointer;" src="images/weixin.jpg" height="47" width="122"/></div>
            <div id="download_a">
                <input style="width: 20px;height: 20px;margin-left: 35px;cursor:pointer;" type="checkbox"><div style="position: absolute;left: 65px;top: 0px;">同意<a style="color: #FEF406" href="">天添画模型交易说明</a></div>
            </div>

            <div>
                <button href="" id="button_right" style="margin-left: 80px" onclick="OnClickDoDownload()" download="wenjian.txt">确定</button><button id="button_left" style="margin-left: 30px" onclick="OnClickEsc()">取消</button>
            </div>
        </div>
    </div>



    <!--<div id="storeroom">-->
    <!--<div class="storeroom_title">-->
    <!--<div style="width: 200px;margin-left: 8px;padding-top: 3px">公有库Save</div>-->
    <!--<div style="width: 5px ;font-weight: bold; padding-top: 4px;margin-left: 17px;cursor:pointer;" onclick="OnClickStoreroom()">X</div>-->
    <!--</div>-->
    <!--<div class="storeroom_main">-->
    <!--<div style="height: 28px;">&nbsp;&nbsp;-->
    <!--刀具品牌<select style="margin:2px 0px 0px 63px;;width: 102px;height: 24px;"><option value="0">Seco</option><option value="1">Prawet</option></select></div>-->
    <!--<div style="height: 28px;border-bottom:1px solid #7A7A7A ;border-top:1px solid #7A7A7A">-->
    <!--&nbsp;&nbsp;&nbsp;文件名<input id="" style="margin:2px 0px 0px 79px;width: 98px;height: 19px;" type="text"/></div>-->
    <!--<div style="height: 28px">-->
    <!--&nbsp;&nbsp;&nbsp;用户名<input id="username" style="margin:2px 0px 0px 79px;width: 98px;height: 19px;" type="text"/></div>-->
    <!--</div>-->
    <!--<div><button class="storeroom_button" onclick="OnClickStoreroom()">取消</button></div>-->
    <!--<div><button class="storeroom_button" onclick="">保存</button></div>-->
    <!--</div>-->




    <div id="progress">
        <div id="progress_title">
            <div style="width: 200px;margin-left: 8px;padding-top: 3px">进度</div>
            <div style="width: 10px ;font-weight: bold; padding: 5px;margin-left: 268px;cursor:pointer;" onclick="HideProgressBar()">X</div>
        </div>
        <div id="porgress_main">
            <canvas id="myCanvas" width="400" height="80" style="margin: 5px  0px 0px 44px; padding: 0px 0px 0px 30px;visibility: hidden;z-index: 1003">Your browser does not have support for canvas.</canvas>
            <div id="progress_foot">
                <div id="zi" style="font-size: 20px;font-weight: bold;text-align:center;position: absolute;left: 110px;top: 80px; visibility: hidden">已完成，请关闭窗口，查看模型</div>
                <div id="tu" style="font-size: 18px;font-weight: bold;text-align:center;">正在生成，请不要关闭，	耐心等待......</div>
                <div style="width: 330px;border-bottom: 2px grey dashed;margin:10px 0px 0px 85px"></div>
            </div>
        </div>
        <div id="progress_bottom">
            <center>
                <div style="width: 88%;height: 400px;margin-top: 20px"><img
                        src="images/guanggao.jpg" height="548" width="400"/></div>
            </center>
        </div>
    </div>
</div>
<script>

    function OnClickCheck() {
        var daojuS = document.getElementById("daojubut");
        daojuS.innerHTML = "Search";
        HideSearchResultPanel();
    }



    //initBindGridEvent();

    var g_dragableElementArray = new Array();
    var g_lastDragObj = null;
    var g_lastDragDiv = null;
    var progressBar = {};
    var progress = 0;
    var contextProgress = null;
    var progressTimer = null;
    progressBar.total_width = 300;
    progressBar.total_height = 34;
    progressBar.initial_x = 20;
    progressBar.initial_y = 20;
    progressBar.radius = progressBar.total_height * 0.5;
    window.onload = function() {
        var elem = document.getElementById('myCanvas');
        if (!elem || !elem.getContext) {
            return;
        }

        contextProgress = elem.getContext('2d');
        if (!contextProgress) {
            return;
        }

        // set font
        contextProgress.font = "16px Verdana";

        // Blue gradient for progress bar
        var progress_lingrad = contextProgress.createLinearGradient(0,progressBar.initial_y + progressBar.total_height,0,0);
        progress_lingrad.addColorStop(0, '#4DA4F3');
        progress_lingrad.addColorStop(0.4, '#ADD9FF');
        progress_lingrad.addColorStop(1, '#9ED1FF');
        contextProgress.fillStyle = progress_lingrad;

        updateProgress(0);
    }

    function onUpdateProgress()
    {
        progress += 0.003;
        updateProgress(progress);
    }
    function updateProgress(progress) {
        if(progress >= 0.99)
        {
            progress = 0.99;
        }

        var x = progress * progressBar.total_width;
        if(contextProgress == null) return;
        // Clear everything before drawing
        contextProgress.clearRect(progressBar.initial_x - 5,progressBar.initial_y - 5,progressBar.total_width + 15,progressBar.total_height + 15);
        progressLayerRect(contextProgress, progressBar.initial_x, progressBar.initial_y, progressBar.total_width, progressBar.total_height, progressBar.radius);
        progressBarRect(contextProgress, progressBar.initial_x, progressBar.initial_y, x, progressBar.total_height, progressBar.radius, progressBar.total_width);
        progressText(contextProgress, progressBar.initial_x, progressBar.initial_y, x, progressBar.total_height, progressBar.radius, progressBar.total_width );
    }

    /**
     * Draws a rounded rectangle.
     * @param {CanvasContext} ctx
     * @param {Number} x The top left x coordinate
     * @param {Number} y The top left y coordinate
     * @param {Number} width The width of the rectangle
     * @param {Number} height The height of the rectangle
     * @param {Number} radius The corner radius;
     */
    function roundRect(ctx, x, y, width, height, radius) {
        ctx.beginPath();
        ctx.moveTo(x + radius, y);
        ctx.lineTo(x + width - radius, y);
        ctx.arc(x+width-radius, y+radius, radius, -Math.PI/2, Math.PI/2, false);
        ctx.lineTo(x + radius, y + height);
        ctx.arc(x+radius, y+radius, radius, Math.PI/2, 3*Math.PI/2, false);
        ctx.closePath();
        ctx.fill();
    }

    /**
     * Draws a rounded rectangle.
     * @param {CanvasContext} ctx
     * @param {Number} x The top left x coordinate
     * @param {Number} y The top left y coordinate
     * @param {Number} width The width of the rectangle
     * @param {Number} height The height of the rectangle
     * @param {Number} radius The corner radius;
     */
    function roundInsetRect(ctx, x, y, width, height, radius) {
        ctx.beginPath();
        // Draw huge anti-clockwise box
        ctx.moveTo(1000, 1000);
        ctx.lineTo(1000, -1000);
        ctx.lineTo(-1000, -1000);
        ctx.lineTo(-1000, 1000);
        ctx.lineTo(1000, 1000);
        ctx.moveTo(x + radius, y);
        ctx.lineTo(x + width - radius, y);
        ctx.arc(x+width-radius, y+radius, radius, -Math.PI/2, Math.PI/2, false);
        ctx.lineTo(x + radius, y + height);
        ctx.arc(x+radius, y+radius, radius, Math.PI/2, 3*Math.PI/2, false);
        ctx.closePath();
        ctx.fill();
    }

    function progressLayerRect(ctx, x, y, width, height, radius) {
        ctx.save();
        // Set shadows to make some depth
        ctx.shadowOffsetX = 2;
        ctx.shadowOffsetY = 2;
        ctx.shadowBlur = 5;
        ctx.shadowColor = '#666';

        // Create initial grey layer
        ctx.fillStyle = 'rgba(189,189,189,1)';
        roundRect(ctx, x, y, width, height, radius);

        // Overlay with gradient
        ctx.shadowColor = 'rgba(0,0,0,0)'
        var lingrad = ctx.createLinearGradient(0,y+height,0,0);
        lingrad.addColorStop(0, 'rgba(255,255,255, 0.1)');
        lingrad.addColorStop(0.4, 'rgba(255,255,255, 0.7)');
        lingrad.addColorStop(1, 'rgba(255,255,255,0.4)');
        ctx.fillStyle = lingrad;
        roundRect(ctx, x, y, width, height, radius);

        ctx.fillStyle = 'white';
        //roundInsetRect(ctx, x, y, width, height, radius);

        ctx.restore();
    }
    /**
     * Draws a half-rounded progress bar to properly fill rounded under-layer
     * @param {CanvasContext} ctx
     * @param {Number} x The top left x coordinate
     * @param {Number} y The top left y coordinate
     * @param {Number} width The width of the bar
     * @param {Number} height The height of the bar
     * @param {Number} radius The corner radius;
     * @param {Number} max The under-layer total width;
     */
    function progressBarRect(ctx, x, y, width, height, radius, max) {
        // var to store offset for proper filling when inside rounded area
        var offset = 0;
        ctx.beginPath();
        if (width<radius) {
            offset = radius - Math.sqrt(Math.pow(radius,2)-Math.pow((radius-width),2));
            ctx.moveTo(x + width, y+offset);
            ctx.lineTo(x + width, y+height-offset);
            ctx.arc(x + radius, y + radius, radius, Math.PI - Math.acos((radius - width) / radius), Math.PI + Math.acos((radius - width) / radius), false);
        }
        else if (width+radius>max) {
            offset = radius - Math.sqrt(Math.pow(radius,2)-Math.pow((radius - (max-width)),2));
            ctx.moveTo(x + radius, y);
            ctx.lineTo(x + width, y);
            ctx.arc(x+max-radius, y + radius, radius, -Math.PI/2, -Math.acos((radius - (max-width)) / radius), false);
            ctx.lineTo(x + width, y+height-offset);
            ctx.arc(x+max-radius, y + radius, radius, Math.acos((radius - (max-width)) / radius), Math.PI/2, false);
            ctx.lineTo(x + radius, y + height);
            ctx.arc(x+radius, y+radius, radius, Math.PI/2, 3*Math.PI/2, false);
        }
        else {
            ctx.moveTo(x + radius, y);
            ctx.lineTo(x + width, y);
            ctx.lineTo(x + width, y + height);
            ctx.lineTo(x + radius, y + height);
            ctx.arc(x+radius, y+radius, radius, Math.PI/2, 3*Math.PI/2, false);
        }
        ctx.closePath();
        ctx.fill();

        // draw progress bar right border shadow
        if (width<max-1) {
            ctx.save();
            ctx.shadowOffsetX = 1;
            ctx.shadowBlur = 1;
            ctx.shadowColor = '#666';
            if (width+radius>max)
                offset = offset+1;
            ctx.fillRect(x +width,y+offset,1,progressBar.total_height-offset*2);
            ctx.restore();
        }
    }

    /**
     * Draws properly-positioned progress bar percent text
     * @param {CanvasContext} ctx
     * @param {Number} x The top left x coordinate
     * @param {Number} y The top left y coordinate
     * @param {Number} width The width of the bar
     * @param {Number} height The height of the bar
     * @param {Number} radius The corner radius;
     * @param {Number} max The under-layer total width;
     */
    function progressText(ctx, x, y, width, height, radius, max) {
        ctx.save();
        ctx.fillStyle = 'white';
        var text = Math.floor(width/max*100)+"%";
        var text_width = ctx.measureText(text).width;
        var text_x = x+width-text_width-radius/2;
        if (width<=radius+text_width) {
            text_x = x+radius/2;
        }
        ctx.fillText(text, text_x, y+22);
        ctx.restore();
    }


    function AddAxisArrowHelper(scene)
    {
        var Xdir = new THREE.Vector3(1,0,0);
        var Ydir = new THREE.Vector3(0,1,0);
        var Zdir = new THREE.Vector3(0,0,1);

        //确定原点，箭头长度，和箭头颜色，三个箭头同一设置
        var origin = new THREE.Vector3(0,0,0);
        var length = 2000;
        var color = 0xffff00;

        //建立三个方向上箭头辅助
        var YarrowHelper = new THREE.ArrowHelper(Ydir,origin,length,0xff0000);
        var ZarrowHelper = new THREE.ArrowHelper(Zdir,origin,length,0x0000ff);
        var XarrowHelper = new THREE.ArrowHelper(Xdir,origin,length,0x00ff00);
        //把箭头辅助加入 场景
        scene.add(YarrowHelper);
        scene.add(ZarrowHelper);
        scene.add(XarrowHelper);
    }

    if ( ! Detector.webgl ) Detector.addGetWebGLMessage();

    var container;
    var modelArray = new Array();
    var camera, scene, renderer;
    var orbitControls;
    var modelNode;
    var xzPlane,xyPlane,yzPlane;
    var axisHelper;
    var lastModelColor;
    var menuObj = {};
    var searchMenuObj = {};
    var zuanTouSearchMenuObj = {};
    var daopianSearchMenuObj = {};
    var JiaTaoSearchMenuObj={};
    var tuZhiMuBanMenuObj = {};
    var jiShuYaoQiuMenuObj = {};
    var yanChangGanSearchMenuObj = {};
    var daoganSearchMenuObj = {};
    var YanJiaTaoSearchMenuObj = {};
    var textureCube;
    var reflectMaterial;
    var m_globalGui = null;
    var m_globalGuiJsonObj = null;
    var m_globalFuncUpdateModel = null;
    var m_globalHandleSearchGui = null;
    var m_globalHandleSearchJsonObj = null;
    var m_globalDaoBinSearchJsonResult = null;
    var m_globalZuanTouSearchJsonResult = null;
    var m_globalYanChangGanSearchGui = null;
    var m_globalYanChangGanSearchJsonObj = null;
    var m_globalTuZhiSearchGui = null;
    var m_globalTuZhiSearchJsonObj = null;
    var m_globalJiShuYaoQiuGui = null;
    var m_globalJiShuYaoQiuJsonObj = null;
    var m_bYanChangGanBtnIsDisable = false;
    var g_serverGenerateID = GenerateUUID();
    var mouseX = 0, mouseY = 0;

    var windowHalfX = window.innerWidth / 2;
    var windowHalfY = window.innerHeight / 2;

    function OnClickDisplayZuoBiaoZhou()
    {
        menuObj["显示坐标轴"] = !menuObj["显示坐标轴"];
    }
    function OnClickDisplayXYPlane()
    {
        menuObj["显示xy平面"] = !menuObj["显示xy平面"];
    }
    function OnClickDisplayYZPlane()
    {
        menuObj["显示yz平面"] = !menuObj["显示yz平面"];
    }
    function OnClickDisplayXZPlane()
    {
        menuObj["显示xz平面"] = !menuObj["显示xz平面"];
    }
    function OnClickUpdateModel()
    {
        menuObj["更新模型"]();
    }
    function CloseAllTab()
    {
        LoadGUIByConfig();

    }
    function OnClickDownloadObj()
    {

    }
    function OnClickDownloadStp()
    {

    }
    function OnClickDownloadAllModel()
    {

    }
    function OnClickDownloadPdf()
    {

    }
    function IsAccessibleToDownload()
    {

    }

    function onClickUpdateModel(geometry,handleLength)
    {
        var material = null;
        if (geometry.hasColors)
        {
            material = new THREE.MeshPhongMaterial({ opacity: geometry.alpha, vertexColors: THREE.VertexColors });
        }
        else
        {
            material = new THREE.MeshPhongMaterial( { color: 0xAAAAAA, specular: 0x111111, shininess: 0 } );
        }

        var mesh = new THREE.Mesh( geometry, material );

        mesh.position.set(handleLength, 0, 0);
        mesh.rotation.set( 0, 0, 0 );
        mesh.scale.set( 1,1,1 );

        mesh.castShadow = true;
        mesh.receiveShadow = true;

        //object.position.y = - 95;
        scene.add( mesh );
        modelArray.push(mesh);

        modelNode = mesh;
    }
    function removeAllSceneModel()
    {
        var i = 0;
        for(i = 0; i < modelArray.length; i++)
        {
            scene.remove(modelArray[i]);
        }

        modelArray = new Array();
    }
    function HideProgressBar()
    {
        var elem = document.getElementById("myCanvas");

        //var es = document.getElementById("zi");
        var e1 = document.getElementById("progress");

        elem.style.visibility = "hidden";
        //es.style.visibility = "hidden";
        e1.style.visibility = "hidden";
        clearInterval(progressTimer);
    }
    function onCallBack(response,handleLength)
    {
        var onProgress = function ( xhr ) {

        };

        var onError = function ( xhr ) {
        };

        var elem = document.getElementById('myCanvas');
        elem.style.visibility = "visible";
        clearInterval(progressTimer);

        removeAllSceneModel();

        var jsonObj = eval('(' + response + ')');
        var modelFileList = jsonObj.ModelFileList;
        var pdfFile = jsonObj.PdfList;
        var pdfCtrl = document.getElementById( 'pdfCtrl' );
        pdfCtrl.src = globalServerAddr + pdfFile;

        var i = 0;
        var requestURL = globalServerAddr + modelFileList;

        var loader = new THREE.STLLoader();
        loader.load(requestURL, function ( geometry ){
            onClickUpdateModel(geometry,0);
        },onProgress,onError);
    }
    function 	onUpdateMenu()
    {
        ReloadDesignGUI(m_globalGuiJsonObj);
    }

    function DisplayModelParam()
    {
        var tableHtmlElement = document.getElementById("divParamList");

        if(tableHtmlElement == null || tableHtmlElement == undefined)
        {
            return;
        }
        /*
        <div style="width:80%">
            序号
        </div>
        * */
        var strHtml = "<div style=\"width:80%\">" + "参数列表:" + "</div>";
        strHtml += "<div style=\"width:80%\">" + "总长L1: " + 10 + "</div>";
        strHtml += "<div style=\"width:80%\">" + "工作长度L2: " + 10 + "</div>";
        strHtml += "<div style=\"width:80%\">" + "工作直径D1: " + 10 + "</div>";
        strHtml += "<div style=\"width:80%\">" + " 柄部长度L3: " + 10 + "</div>";
        strHtml += "<div style=\"width:80%\">" + "柄部直径D2: " + 10 + "</div>";

        tableHtmlElement.innerHTML = strHtml;

        tableHtmlElement.style.display = "display";
    }
    function HideModelParam()
    {
        var tableHtmlElement = document.getElementById("SearchTable");

        if(tableHtmlElement == null || tableHtmlElement == undefined)
        {
            return;
        }

        tableHtmlElement.style.display = "hidden";
    }
    function onSearchDaoBingCallBack(strJson)
    {
        var jsonObj = eval('(' + strJson + ')');
        m_globalDaoBinSearchJsonResult = jsonObj;
        var searchDiv = document.getElementById("SearchTable");
        var strTableHtml = "<table class=\"editableTable\" border=\"0\" style=\"position: absolute;left: 300px;top: 200px;overflow:scroll;width: 800px;\">";
        strTableHtml += "<tr class=\"editable simpleInput\">";
        strTableHtml += "<th style=\"width: 60px;\">序号</th>";
        strTableHtml += "<th style=\"width: 60px;\">ID</th>";
        strTableHtml += "<th style=\"width: 60px;\">尾端类型</th>";
        strTableHtml += "<th style=\"width: 60px;\">前段类型</th>";
        strTableHtml += "<th style=\"width: 60px;\">夹持直径</th>";
        strTableHtml += "<th style=\"width: 60px;\">有效长度</th>";
        strTableHtml += "<th style=\"width: 60px;\">";
        strTableHtml += "<div class=\"closebutton\" style=\"position: absolute;width: 30px;margin-left: 14px;margin-top: -9px;padding-left: 0px;padding-top: 0px;\" onclick=\"HideSearchResultPanel()\">关闭</div>";
        strTableHtml += "</th>";
        strTableHtml += "</tr>";

        for(var i = 0; i < jsonObj.length; i++)
        {
            var paramList = jsonObj[i].ParamList;
            strTableHtml += "<tr class=\"editable simpleInput\">";
            strTableHtml += "<td>" + (i + 1) + "</td>";
            strTableHtml += "<td>" + paramList[0].Value + "</td>";
            strTableHtml += "<td>" + paramList[1].Value + "</td>";
            strTableHtml += "<td>" + paramList[2].Value + "</td>";
            strTableHtml += "<td>" + paramList[3].Value + "</td>";
            strTableHtml += "<td>" + paramList[4].Value + "</td>";
            strTableHtml += "<td>" + "<div class=\"smallbutton\" style=\"position: absolute;width: 30px;margin-left: 14px;margin-top: -9px;padding-left: 0px;padding-top: 0px;\" onclick=\"OnZuZhuang(" + i + ",onCallBack)\">更新</div>" + "</td>";
            strTableHtml += "</tr>";
        }
        strTableHtml += "</table>";

        searchDiv.innerHTML = strTableHtml;

        HideProgressBar();
        var divElement = document.getElementById("SearchTable");
        divElement.style.visibility = "visible";
    }

    // function onSearchZuanTouCallBack(strJson)
    // {
    //    var jsonObj = eval('(' + strJson + ')');
    //    m_globalZuanTouSearchJsonResult = jsonObj;
    //    var searchDiv = document.getElementById("SearchTable");
    //    var strTableHtml = "<table class=\"editableTable\" border=\"0\" style=\"position: absolute;left: 300px;top: 200px;overflow:scroll;width: 800px;\">";
    //    strTableHtml += "<tr class=\"editable simpleInput\">";
    //    strTableHtml += "<th style=\"width: 60px;\">序号</th>";
    //    strTableHtml += "<th style=\"width: 60px;\">名称</th>";
    //    strTableHtml += "<th style=\"width: 60px;\">总长</th>";
    //    strTableHtml += "<th style=\"width: 60px;\">工作长度</th>";
    //    strTableHtml += "<th style=\"width: 60px;\">直径</th>";
    //    strTableHtml += "<th style=\"width: 60px;\">";
    //    strTableHtml += "<div class=\"closebutton\" style=\"position: absolute;width: 30px;margin-left: 14px;margin-top: -9px;padding-left: 0px;padding-top: 0px;\" onclick=\"HideSearchResultPanel()\">关闭</div>";
    //    strTableHtml += "</th>";
    //    strTableHtml += "</tr>";
    //
    //    for(var i = 0; i < jsonObj.length; i++)
    //    {
    //        var paramList = jsonObj[i].ParamList;
    //        strTableHtml += "<tr class=\"editable simpleInput\">";
    //        strTableHtml += "<td>" + (i + 1) + "</td>";
    //        strTableHtml += "<td>" + paramList[0].Value + "</td>";
    //        strTableHtml += "<td>" + paramList[1].Value + "</td>";
    //        strTableHtml += "<td>" + paramList[2].Value + "</td>";
    //        strTableHtml += "<td>" + paramList[3].Value + "</td>";
    //        strTableHtml += "<td>" + "<div class=\"smallbutton\" style=\"position: absolute;width: 30px;margin-left: 14px;margin-top: -9px;padding-left: 0px;padding-top: 0px;\" onclick=\"OnUpdateZuanTou(" + i +",onCallBack)\">更新</div>" + "</td>";
    //        strTableHtml += "</tr>";
    //    }
    //    strTableHtml += "</table>";
    //
    //    searchDiv.innerHTML = strTableHtml;
    //
    //    HideProgressBar();
    //    var divElement = document.getElementById("SearchTable");
    //    divElement.style.visibility = "visible";
    // }

    function onSearchZuanTouCallBacks(strJson)
    {
        var jsonObj = eval('(' + strJson + ')');
        m_globalZuanTouSearchJsonResult = jsonObj;
        var searchDiv = document.getElementById("SearchTable");
        var strTableHtml = "<table class=\"editableTable\" border=\"0\" style=\"position: absolute;left: 500px;top: 200px;overflow:scroll;width: 400px;\">";
        strTableHtml += "<tr class=\"editable simpleInput\">";
        strTableHtml += "<th style=\"width: 60px;\">选项</th>";
        strTableHtml += "<th style=\"width: 60px;\">序号</th>";
        strTableHtml += "<th style=\"width: 60px;\">订货型号</th>";
        strTableHtml += "<th style=\"width: 60px;\">";
        strTableHtml += "<div class=\"closebutton\" style=\"position: absolute;width: 30px;margin-left: 5px;margin-top: -9px;padding-left: 0px;padding-top: 0px;\" onclick=\"OnClickCheck()\">确定</div>";
        strTableHtml += "<div class=\"closebutton\" style=\"position: absolute;width: 30px;margin-left: 45px;margin-top: -9px;padding-left: 0px;padding-top: 0px;\" onclick=\"HideSearchResultPanel()\">关闭</div>";
        strTableHtml += "</th>";
        strTableHtml += "</tr>";

        for(var i = 0; i < jsonObj.length; i++)
        {
            var string = (i == 0 ? "checked" : "unchecked");
            var paramList = jsonObj[i].ParamList;
            strTableHtml += "<tr class=\"editable simpleInput\">";
            strTableHtml += "<td>" + "<input type='radio' name='ra' value='"+ i + "'"+ string +" /> " + "</td>";
            strTableHtml += "<td>" + (i + 1) + "</td>";
            strTableHtml += "<td>" + paramList[1].Value + "</td>";
            strTableHtml += "<td>" + "<div class=\"smallbutton\" style=\"position: absolute;width: 30px;margin-left: 24px;margin-top: -9px;padding-left: 0px;padding-top: 0px;\" onclick=\"\">查看</div>" + "</td>";
            strTableHtml += "</tr>";
        }
        strTableHtml += "</table>";
        strTableHtml += "<div  border=\"0\" style=\"position: absolute;left: 900px;top: 200px;width: 300px;height: 300px;padding: 10px;background-color: #DDEEF6;border:1px solid #DDEEF6;-webkit-border-radius: 6px;-moz-border-radius: 6px;\">12131</div>"

        searchDiv.innerHTML = strTableHtml;

        HideProgressBar();
        var divElement = document.getElementById("SearchTable");
        divElement.style.visibility = "visible";
    }

    function onSearchJiaTaoCallBack(strJson)
    {
        var jsonObj = eval('(' + strJson + ')');
        m_globalZuanTouSearchJsonResult = jsonObj;
        var searchDiv = document.getElementById("SearchTable");
        var strTableHtml = "<table class=\"editableTable\" border=\"0\" style=\"position: absolute;left: 500px;top: 200px;overflow:scroll;width: 400px;\">";
        strTableHtml += "<tr class=\"editable simpleInput\">";
        strTableHtml += "<th style=\"width: 60px;\">序号</th>";
        strTableHtml += "<th style=\"width: 60px;\">名称</th>";
        strTableHtml += "<th style=\"width: 60px;\">";
        strTableHtml += "<div class=\"closebutton\" style=\"position: absolute;width: 30px;margin-left: 45px;margin-top: -9px;padding-left: 0px;padding-top: 0px;\" onclick=\"HideSearchResultPanel()\">关闭</div>";
        strTableHtml += "</th>";
        strTableHtml += "</tr>";

        for(var i = 0; i < jsonObj.length; i++)
        {
            var paramList = jsonObj[i].ParamList;
            strTableHtml += "<tr class=\"editable simpleInput\">";
            strTableHtml += "<td>" + (i + 1) + "</td>";
            strTableHtml += "<td>" + paramList[0].Value + "</td>";
            strTableHtml += "<td>" + "<div class=\"smallbutton\" style=\"position: absolute;width: 30px;margin-left: 14px;margin-top: -9px;padding-left: 0px;padding-top: 0px;\" onclick=\"OnUpdateZuanTou(" + i +",onCallBack)\">更新</div>" + "</td>";
            strTableHtml += "</tr>";
        }
        strTableHtml += "</table>";
        strTableHtml += "<div  border=\"0\" style=\"position: absolute;left: 900px;top: 200px;width: 200px;height: 200px;padding: 10px;background-color: #DDEEF6;border:1px solid #DDEEF6;-webkit-border-radius: 6px;-moz-border-radius: 6px;\">12131</div>"

        searchDiv.innerHTML = strTableHtml;

        HideProgressBar();
        var divElement = document.getElementById("SearchTable");
        divElement.style.visibility = "visible";
    }

    function onSearchYanJiaCallBack(strJson)
    {
        var jsonObj = eval('(' + strJson + ')');
        m_globalZuanTouSearchJsonResult = jsonObj;
        var searchDiv = document.getElementById("SearchTable");
        var strTableHtml = "<table class=\"editableTable\" border=\"0\" style=\"position: absolute;left: 500px;top: 200px;overflow:scroll;width: 400px;\">";
        strTableHtml += "<tr class=\"editable simpleInput\">";
        strTableHtml += "<th style=\"width: 60px;\">序号</th>";
        strTableHtml += "<th style=\"width: 60px;\">名称</th>";
        strTableHtml += "<th style=\"width: 60px;\">";
        strTableHtml += "<div class=\"closebutton\" style=\"position: absolute;width: 30px;margin-left: 45px;margin-top: -9px;padding-left: 0px;padding-top: 0px;\" onclick=\"HideSearchResultPanel()\">关闭</div>";
        strTableHtml += "</th>";
        strTableHtml += "</tr>";

        for(var i = 0; i < jsonObj.length; i++)
        {
            var paramList = jsonObj[i].ParamList;
            strTableHtml += "<tr class=\"editable simpleInput\">";
            strTableHtml += "<td>" + (i + 1) + "</td>";
            strTableHtml += "<td>" + paramList[0].Value + "</td>";
            strTableHtml += "<td>" + "<div class=\"smallbutton\" style=\"position: absolute;width: 30px;margin-left: 14px;margin-top: -9px;padding-left: 0px;padding-top: 0px;\" onclick=\"OnUpdateZuanTou(" + i +",onCallBack)\">更新</div>" + "</td>";
            strTableHtml += "</tr>";
        }
        strTableHtml += "</table>";
        strTableHtml += "<div  border=\"0\" style=\"position: absolute;left: 900px;top: 200px;width: 200px;height: 200px;padding: 10px;background-color: #DDEEF6;border:1px solid #DDEEF6;-webkit-border-radius: 6px;-moz-border-radius: 6px;\">12131</div>"

        searchDiv.innerHTML = strTableHtml;

        HideProgressBar();
        var divElement = document.getElementById("SearchTable");
        divElement.style.visibility = "visible";
    }
    // function OnFinishLoadLeftPanel()
    // {
    //    var yan = document.getElementById("YanChangGanComboBox");
    //
    //    var zhuangpei = document.getElementById("ZhuangPei");
    //
    //    // if () {
    // 	// 	zhuangpei.onclick = "";
    //     //    zhuangpei.style.backgroundColor = "gray";
    // 	// }
    //
    //
    //    var yanchangganSearch = document.getElementById("yanchangganSearch");
    //    var yanchangganDesign = document.getElementById("yanchangganDesign");
    //    var yanjiaS = document.getElementById("yanjiaSearch");
    //    var yanjiaD = document.getElementById("yanjiaDesign");
    //    if (yan.value == 0)
    //    {
    //        yanchangganSearch.style.backgroundColor = "gray";
    //        yanchangganDesign.style.backgroundColor = "gray";
    //        yanjiaS.style.backgroundColor = "gray";
    //        yanjiaD.style.backgroundColor = "gray";
    //    }
    //
    // }
    function onClickUpdateCallBack()
    {
        //这里显示进度条，并且把界面封印起来
        progress = 0;

        var elem = document.getElementById('myCanvas');
        var e1 = document.getElementById("progress");
        elem.style.visibility = "visible";


        e1.style.visibility = "visible";
        progressTimer = setInterval(onUpdateProgress,150);
    }

    RequestServerGenerateID();


    // //刀片Search
    // LoadDaoPianSearchGUI("config/CaoDao_PuTongWaiYuanCaoDao_DaoPianSearch.json",daopianSearchMenuObj,onSearchZuanTouCallBacks);

    // //外圆槽刀杆Search
    // LoadDaoGanSearchGUIMockData("config/daogan_config_1.json",daoganSearchMenuObj,onSearchYanChangGanCallBackMockData,ReloadYanChangGanSearchMenu);

    // //外圆槽刀杆Design
    // LoadDesignGUI("config/CaoDao_PuTongWaiYuanCaoDao_DaoGanDesign.json",onCallBack,menuObj,onClickUpdateCallBack,onUpdateMenu);



    LoadLeftPanelUIConfig("config/UI/EdgeWinDesignLeftPanel_xidao_daopanshichaxidao.json");

    //刀片Search
    LoadZuanTouSearchGUI("config/CaoDao_CDaoPianCWN_DaoGanDesign.json",zuanTouSearchMenuObj,onSearchZuanTouCallBacks);

    //刀杆Design
    LoadDesignGUI("config/XiDao_DaoPanShiC_Design.json",onCallBack,menuObj,onClickUpdateCallBack,onUpdateMenu);


    //延长杆Search
    LoadYanChangGanSearchGUIMockData("config/daogan_config_1.json",yanChangGanSearchMenuObj,onSearchYanChangGanCallBackMockData,ReloadYanChangGanSearchMenu);


    LoadTuZhiMuBanGUI("config/tuZhiMuBan.json",tuZhiMuBanMenuObj,onTuZhiMuBanClickQueDing);

    //技术
    LoadJiShuYaoQiuGUI("config/jiShuYaoQiu.json",jiShuYaoQiuMenuObj,onJiShuYaoQiuClickQueDing);

    LoadBaoJiaGUI("config/BaoJia/BaoJiaXinXi.json",zuanTouSearchMenuObj);RequestUserInfo();

    AddDragableDivElement('progress');
    InitDragableElementEvent();
    div();
    init();
    animate();

    //DisplayModelParam();
    DisplayParamList();
    DisplayTechRequest();

    function init()
    {
        container = document.getElementById( 'gameCanvas');
        //container.width = 800;
        //container.height = 600;
        //document.body.appendChild( container );

        camera = new THREE.PerspectiveCamera( 45, 1920 / 820, 0.01, 2000 );
        camera.position.z = 260;
        camera.position.x = 0;

        // scene

        scene = new THREE.Scene();

        var ambientLight = new THREE.AmbientLight( 0xcccccc, 0.4 );
        scene.add( ambientLight );

        var pointLight = new THREE.PointLight( 0xffffff, 0.8 );
        camera.add( pointLight );
        scene.add( camera );

        axisHelper = new THREE.AxisHelper(1000);
        axisHelper.material.depthTest = false;
        scene.add(axisHelper);

        var planeGeometry = new THREE.PlaneGeometry(60,40,10,10);
        //平面材质，基本材质是渲染不出阴影的，下面的材质可以，仅仅指定颜色
        var planeMaterial = new THREE.MeshLambertMaterial({color:0xff00dd});
        planeMaterial.wireframe = true;
        //以给定的尺寸和材质构建一个平面
        xzPlane = new THREE.Mesh(planeGeometry,planeMaterial);
        //指定平面的旋转角度，方便观察
        xzPlane.rotation.x = -0.5 * Math.PI;
        //平面的位置
        xzPlane.position.x = 0;
        xzPlane.position.y = 0;
        xzPlane.position.z = 0;
        //平面加入场景
        scene.add(xzPlane);

        planeMaterial = new THREE.MeshLambertMaterial({color:0x00ffdd});
        planeMaterial.wireframe = true;
        yzPlane = new THREE.Mesh(planeGeometry,planeMaterial);
        yzPlane.rotation.y = -0.5 * Math.PI;
        yzPlane.position.x = 0;
        yzPlane.position.y = 0;
        yzPlane.position.z = 0;
        scene.add(yzPlane);

        planeMaterial = new THREE.MeshLambertMaterial({color:0xffdd00});
        planeMaterial.wireframe = true;
        xyPlane = new THREE.Mesh(planeGeometry,planeMaterial);
        //指定平面的旋转角度，方便观察
        xyPlane.rotation.z = -0.5 * Math.PI;
        //平面的位置
        xyPlane.position.x = 0;
        xyPlane.position.y = 0;
        xyPlane.position.z = 0;
        //平面加入场景
        scene.add(xyPlane);

        var path = "../examples/textures/cube/skybox/";
        var urls = [
            path + "px.jpg", path + "nx.jpg",
            path + "py.jpg", path + "ny.jpg",
            path + "pz.jpg", path + "nz.jpg"
        ];

        textureCube = new THREE.CubeTextureLoader().load( urls );
        reflectMaterial = new THREE.MeshPhongMaterial( { color: 0xe4e4e4, envMap: textureCube, side: THREE.DoubleSide } );

        //AddAxisArrowHelper(scene);

        // texture

        var manager = new THREE.LoadingManager();
        manager.onProgress = function ( item, loaded, total ) {

            console.log( item, loaded, total );

        };

        // model

        var onProgress = function ( xhr ) {
            if ( xhr.lengthComputable ) {
                var percentComplete = xhr.loaded / xhr.total * 100;
                console.log( Math.round(percentComplete, 2) + '% downloaded' );
            }
        };

        var onError = function ( xhr ) {
        };

        //var loader = new THREE.OBJLoader( manager );
        //var loader = new THREE.PLYLoader();
        var material = new THREE.MeshPhongMaterial( { color: 0xAAAAAA, specular: 0x111111, shininess: 200 } );
        var loader = new THREE.STLLoader();
        //loader.load( 'obj/male02/male02.obj', function ( object ) {
        loader.load( 'obj/test/edgewin.stl', function ( geometry ){
            //loader.load( 'http://localhost:1337', function ( geometry ) {
            onClickUpdateModel(geometry,0,0);
        }, onProgress, onError );

        //

        renderer = new THREE.WebGLRenderer({
            antialias: true,
            alpha: true
        });
        this.renderer.setClearColor(0x000000, 0);
        renderer.setPixelRatio( window.devicePixelRatio );
        renderer.setSize( 1920,820 );
        container.appendChild( renderer.domElement );

        orbitControls = new THREE.OrbitControls( camera, renderer.domElement );
        orbitControls.minDistance = 5;
        orbitControls.maxDistance = 1000;
        orbitControls.maxPolarAngle = Math.PI;

        //document.addEventListener( 'mousemove', onDocumentMouseMove, false );

        //

        //window.addEventListener( 'resize', onWindowResize, false );

    }

    function onWindowResize() {

        var width = 1920;
        var height = 1080;
        windowHalfX = window.innerWidth / 2;
        windowHalfY = window.innerHeight / 2;

        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();

        renderer.setSize( window.innerWidth, window.innerHeight );

    }

    function onDocumentMouseMove( event ) {

        mouseX = ( event.clientX - windowHalfX ) * 0.5;
        mouseY = ( event.clientY - windowHalfY ) * 0.5;

    }

    //

    function animate() {

        requestAnimationFrame( animate );
        render();
    }

    function update()
    {
        var i = 0;

        for(i = 0; i < modelArray.length; i++)
        {
            modelArray[i].material = reflectMaterial;
        }

        axisHelper.visible = menuObj["显示坐标轴"];
        xzPlane.visible = menuObj["显示xz平面"];
        xyPlane.visible = menuObj["显示xy平面"];
        yzPlane.visible = menuObj["显示yz平面"];
    }
    function render() {


        update();
        //camera.position.x += ( mouseX - camera.position.x ) * .05;
        //camera.position.y += ( - mouseY - camera.position.y ) * .05;

        //camera.lookAt( scene.position );
        renderer.render( scene, camera );
    }
    function jisuan(obj) {

        var total = 0;

        var fruits = document.getElementsByName("fruit");

        for (var index = 0; index < fruits.length; index++) {

            if (fruits[index].checked) {

                total += parseFloat(fruits[index].value);

            }

        }

        myspan.innerHTML = total + ".00元";
    }

    window.onload = function () {

        var obox = document.getElementById("download_main_top");

        var inputs = obox.getElementsByClassName("che");

        for (var index = 0; index < inputs.length; index++) {

            inputs[index].onclick = function () {

                jisuan(this)

            }

        }
    }

    function OnClickJiShuBlock(){
        var e1 = document.getElementById('divParamList');
        var e2 = document.getElementById('techRequest');
        var e3 = document.getElementById('JiShuButton');
        e3.innerHTML = (e3.innerHTML == "技术条件显示") ? "技术条件关闭":"技术条件显示";
        if (e3.innerHTML == "技术条件显示") {
            e1.style.visibility = e2.style.visibility = "hidden";
        } else {
            UpdateParamList();
            e1.style.visibility = e2.style.visibility = "visible";
        }

        // e1.style.visibility =  (e1.style.visibility == "visible"  ) ? "hidden" : "visible";
        //
        // e2.style.visibility =  (e2.style.visibility == "visible"  ) ? "hidden" : "visible";
    }
    function UpdateParamList()
    {
        var tableHtmlElement = document.getElementById("divParamList");

        if(tableHtmlElement == null || tableHtmlElement == undefined)
        {
            return;
        }

        //m_globalJiShuYaoQiuJsonObj;
        var paramList = m_globalGuiJsonObj.Tab[0].ParamList;

        // var strcaodao = paramList[0]["普通外圆槽刀"];
        // var strzuantoupinpai = paramList[1]["刀具品牌"];
        // var strzuantouxinghao = paramList[2]["订货型号"];
        // var strwenjianming = paramList[3][paramList[3].Name];
        // var strleixing = paramList[4]["类型"];
        // var strszhupianjiao = paramList[5]["主偏角"];
        // var strgaodu = paramList[6]["刀杆高度"];
        // var strzongchang = paramList[7]["总长"];
        // var strapkuan = paramList[8]["AP宽"];
        // var strapshen = paramList[9]["AP深"];
        // var strf1 = paramList[10]["F1"];
        // var strl3 = paramList[11]["L3"];
        var strHtml = "<div style=\"width:80%\">" + paramList[0].Name + "</div>";
        for (i = 0;i<= paramList.length-1;i++)
        {
            var  str = paramList[i][paramList[i].Name];
            strHtml += "<div style=\"width:80%\">" + (i+1)+"."+[paramList[i].Name]+":" + str + "</div>";

            if(paramList[i].Type == "ComboBox")
            {
                var strChoise = paramList[i].Choise;
                var strValue = paramList[i][paramList[i].Name];
                var str2 = strChoise.split(",")[parseInt(strValue)];
            }
        }



        // var strHtml = "<div style=\"width:80%\">" + "钻头:" + "</div>";
        // strHtml += "<div style=\"width:80%\">" + "1.钻头: " + (strcaodao ==0?"普通外圆槽刀":"普通外圆槽刀") + "</div>";
        // strHtml += "<div style=\"width:80%\">" + "2.刀具品牌: " + (strzuantoupinpai ==0?"Seco":"Prawet") +  "</div>";
        // strHtml += "<div style=\"width:80%\">" + "3.订货型号: " + strzuantouxinghao + "</div>";
        // strHtml += "<div style=\"width:80%\">" + "4.文件名: " + strwenjianming + "</div>";
        // strHtml += "<div style=\"width:80%\">" + "5.类型: " + (strleixing ==0? "左":"右") + "</div>";
        // strHtml += "<div style=\"width:80%\">" + "6.主偏角: " + strszhupianjiao + "</div>";
        // strHtml += "<div style=\"width:80%\">" + "7.刀杆高度: " + strgaodu + "</div>";
        // strHtml += "<div style=\"width:80%\">" + "8.总长: " + strzongchang + "</div>";
        // strHtml += "<div style=\"width:80%\">" + "9.AP宽: " + strapkuan + "</div>";
        // strHtml += "<div style=\"width:80%\">" + "10.AP深: " + strapshen + "</div>";
        // strHtml += "<div style=\"width:80%\">" + "11.F1: " + strf1 + "</div>";
        // strHtml += "<div style=\"width:80%\">" + "12.L3: " + strl3 + "</div>";

        tableHtmlElement.innerHTML = strHtml;

        tableHtmlElement.style.visibility = "visible";
        g_bDisplayParamList = true;
    }


</script>

</body>
</html>
